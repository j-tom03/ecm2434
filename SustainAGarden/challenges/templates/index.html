<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css?family=Roboto:400,700|Open+Sans:400,700&display=swap"
        />
        <link rel="stylesheet" href="../static/index/styles.css" />
        <script src="../static/index/script.js"></script>
        <title>SustainAGarden</title>
    </head>
    <body>
        {% if user.is_authenticated %}
        <div class="nav">
            <div id="title">
                <img src="../static/index/Logo.png" alt="Logo" />
            </div>
            <button id="profileButton">Profile</button>
            {% if user.setter %}
            <button
                onclick="window.location.href = '/challenges/set-challenge'"
                value="Add Challenge"
            >
                Add Challenge
            </button>
            {% endif %}
            <button id="shopButton">Shop</button>
            <div id="coins">Coins: {{coins}}</div>
            <!-- coins from account -->
            <form action="/challenges/" method="post">
                {% csrf_token %}
                <input type="hidden" name="form_id" value="logout" />
                <input type="submit" value="Logout" />
            </form>
        </div>
        <div id="profileInfo" style="display: none">
            <div class="profileHeader">{{username}}</div>
            <!-- username -->
            <div class="profileContent">
                <div class="profileAvatar">
                    <img src="../static/index/avatar.jpg" alt="Avatar" />
                    <!-- profile image from user -->
                </div>
                <div class="profileDetails">
                    <div id="challengeCounter">
                        Challenges Completed: {{challenges_completed}}
                    </div>
                    <!-- challenge count from user -->
                    <div id="coinsCounter">Coins: {{coins}}</div>
                    <!-- coins from account -->
                </div>
            </div>
        </div>
        <div id="shopInfo" style="display: none">
            <div class="shopHeader">Shop</div>
            <div id="item-board">
                <div class="item">
                    <img
                        src="../static/index/flowers.png"
                        alt="flowers"
                        id="flower"
                    />
                    <span>Flowers (20)</span>
                </div>
                <div class="item">
                    <img
                        src="../static/index/trees.png"
                        alt="flowers"
                        id="tree"
                    />
                    <span>Tree (40)</span>
                </div>
                <div class="item" id="grass">
                    <img
                        src="../static/index/grass.png"
                        alt="flowers"
                        id="grass"
                    />
                    <span>grass (10)</span>
                </div>
            </div>
        </div>
        <div id="main-container">
            <div id="plot-wrapper"><div id="plot-container"></div></div>
            <div id="challenges">
                <h3>Challenges</h3>
                <ul>
                    <li>Walk 20 miles</li>
                    <li>recycle 10 cans</li>
                    <li>plant a tree</li>
                </ul>
            </div>
        </div>
        <div id="bottomBar">
            <div id="bottomBarButton">
                <img src="../static/index/up.png" alt="" />
            </div>
            <div id="bottomBarContent" style="display: none">
                <div id="game-board">
                    <div id="question">
                    </div>
                    <div id="answers">
                    </div>
                    <script>load_challenges()</script>
                </div>
            </div>
        </div>
        <script>
            create_grid(18, 9);
        </script>
        {% else %}
        <div id="login_wrapper">
            <div id="login_form" style="display: block">
                <h1>Log in to your Account:</h1>
                <form action="/challenges/" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="form_id" value="login" />
                    {{ login_form }}
                    <input type="submit" value="Submit" />
                    <p>
                        Don't have an account?
                        <button onclick="toggleForms()">Register</button>
                    </p>
                </form>
            </div>
            <div id="register_form" style="display: none">
                <h1>Or Register:</h1>
                <form action="/challenges/" method="post">
                    {% csrf_token %}
                    <input type="hidden" name="form_id" value="register" />
                    {{ register_form }}
                    <input type="submit" value="Submit" />
                    <p>
                        Already have an account?
                        <button onclick="toggleForms()">Login</button>
                    </p>
                </form>
            </div>
        </div>
        {% endif %}
    </body>
    <script>
        function privacyNotice() {
            alert("By using this website, you agree to our privacy policy.");
            document.cookie = "shown=1";
        }
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(";").shift();
        }
        if (getCookie("shown") != 1) {
            privacyNotice();
        }
    </script>
</html>
